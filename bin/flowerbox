#!/usr/bin/env ruby

require 'flowerbox'
require 'thor'

class Flowerbox::CLI < Thor
  desc "test DIR", "Run the specs found in spec dir, loading spec_helper.rb for configuration details"
  method_options :pwd => :string
  method_options :runners => :string
  method_options :verbose => false
  def test(dir = "spec/javascripts")
    Dir.chdir(pwd) do
      exit Flowerbox.run(dir, options)
    end
  end

  default_task :test

  no_tasks do
    def pwd
      options[:pwd] || Dir.pwd
    end

    def asset_paths
      Flowerbox.asset_paths.collect { |path| File.join(pwd, path) }
    end
  end
end

Flowerbox::CLI.start

